---
import Layout from '../layouts/Layout.astro';
import { Button } from '@/components/ui/button';
import { NewsletterDialog } from '@/components/NewsletterDialog';
import { ArrowRight, Download, ExternalLink, Mail } from 'lucide-react';
---

<Layout title="HENRIK makes">
  <main class="container mx-auto px-4 py-16 max-w-5xl">
    <!-- Hero Section -->
    <section class="mb-24 text-center">
      <h1 class="text-4xl font-bold mb-4">Hey üëã I am Henrik</h1>
      <p class="text-lg text-muted-foreground">
        I make products with the help of AI assistants. Here's my journey and what I'm working on.
      </p>
    </section>

    <!-- Newsletter Signup -->
    <div class="relative py-16 mb-24 min-h-[300px]">
      <!-- Background wrapper with brushstroke -->
      <img 
        src="/images/brushStroke2.svg"
        alt=""
        class="absolute left-1/2 -translate-x-1/2 w-[120%] max-w-none"
        style="top: -10%; height: 120%;"
        inert
      />

      <!-- Newsletter content -->
      <section class="relative">
        <div class="text-center mb-8">
          <h2 class="text-2xl font-bold mb-2">The Gen X Maker Newsletter</h2>
          <p class="text-muted-foreground">Weekly insights from starting over and becoming an AI-powered maker</p>
        </div>
        <div class="max-w-xl mx-auto">
          <form 
            id="newsletter-form" 
            class="flex gap-2"
          >
            <input 
              type="email" 
              name="email"
              placeholder="Enter your email address" 
              class="flex-1 h-10 px-4 rounded-md bg-background ring-1 ring-input"
              required
            />
            <Button 
              type="submit" 
              variant="default" 
              className="h-10"
              id="submit-button"
            >
              Subscribe
            </Button>
          </form>
          <p 
            id="form-message" 
            class="text-sm mt-2 text-center hidden"
          ></p>
          <p class="text-sm text-muted-foreground mt-2 text-center">
            No spam. Unsubscribe at any time.
          </p>
        </div>
      </section>
    </div>

    <NewsletterDialog client:load />

    <script>
      const form = document.getElementById('newsletter-form') as HTMLFormElement;
      const submitButton = document.getElementById('submit-button') as HTMLButtonElement;

      function showDialog(success: boolean, title: string, message: string) {
        document.dispatchEvent(
          new CustomEvent('toggle-dialog', {
            detail: {
              open: true,
              title,
              message,
              success
            }
          })
        );
      }

      if (form && submitButton) {
        form.addEventListener('submit', async (event) => {
          event.preventDefault();
          
          const originalButtonText = submitButton.textContent || 'Subscribe';
          submitButton.textContent = 'Subscribing...';
          submitButton.disabled = true;
          
          try {
            const formData = new FormData(form);
            const email = formData.get('email');
            console.log('Submitting email:', email);
            
            const response = await fetch('/api/newsletter-subscribe', {
              method: 'POST',
              body: JSON.stringify({ email }),
              headers: {
                'Content-Type': 'application/json'
              }
            });
            
            const data = await response.json();
            console.log('Response:', data);
            
            if (response.ok) {
              showDialog(
                true,
                "You're almost there! üéâ",
                "Please check your inbox (and spam folder) to confirm your subscription. Can't wait to share my journey with you :)"
              );
              form.reset();
            } else {
              showDialog(
                false,
                "Oops! Something went wrong",
                data.message || "Failed to subscribe. Please try again later."
              );
            }
          } catch (error) {
            console.error('Submission error:', error);
            showDialog(
              false,
              "Connection Error",
              "We couldn't process your subscription. Please check your connection and try again."
            );
          } finally {
            submitButton.textContent = originalButtonText;
            submitButton.disabled = false;
          }
        });
      }
    </script>

    <!-- Dumb Things I've Built -->
    <section class="mb-24">
      <h2 class="text-2xl font-bold mb-6">Dumb Things I've Built</h2>
      <div class="space-y-8">
        <div class="flex items-start gap-4">
          <span class="text-xl">üöÄ</span>
          <div>
            <h3 class="font-semibold mb-2">TweetHunter Clone</h3>
            <p class="text-muted-foreground">Built and failed spectacularly. Learned a ton about Twitter API.</p>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <span class="text-xl">üí°</span>
          <div>
            <h3 class="font-semibold mb-2">AI Meme Generator</h3>
            <p class="text-muted-foreground">Generated 1000+ memes. Nobody used it. Great learning experience!</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Current Focus -->
    <section class="mb-24">
      <h2 class="text-2xl font-bold mb-6">Current Focus</h2>
      <div class="space-y-8">
        <div class="flex items-start gap-4">
          <span class="text-xl">üéØ</span>
          <div>
            <h3 class="font-semibold mb-2">Building revid.ai</h3>
            <p class="text-muted-foreground">Creating an AI-powered video generation platform for creators</p>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <span class="text-xl">üìà</span>
          <div>
            <h3 class="font-semibold mb-2">Growing SuperX.so</h3>
            <p class="text-muted-foreground">Helping creators grow their Twitter presence</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Work with Me -->
    <section class="mb-24">
      <h2 class="text-2xl font-bold mb-6">Work with Me</h2>
      <div class="flex items-start gap-4">
        <span class="text-xl">ü§ù</span>
        <div>
          <p class="text-muted-foreground mb-4">I'm available for AI product consulting and technical advisory roles.</p>
          <Button asChild>
            <a href="mailto:your@email.com" class="inline-flex items-center gap-2">
              Get in Touch
              <Mail className="w-4 h-4" />
            </a>
          </Button>
        </div>
      </div>
    </section>

    <!-- Free Resources and Guides -->
    <section class="mb-24">
      <h2 class="text-2xl font-bold mb-6">Free Resources & Guides</h2>
      <div class="space-y-8">
        <div class="flex items-start gap-4">
          <span class="text-xl">üìö</span>
          <div>
            <h3 class="font-semibold mb-2">AI Product Launch Playbook</h3>
            <p class="text-muted-foreground mb-2">A step-by-step guide to launching AI products</p>
            <a href="#" class="inline-flex items-center gap-1 text-blue-500 hover:text-blue-600 font-medium">
              Download PDF
              <Download className="w-4 h-4" />
            </a>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <span class="text-xl">üé•</span>
          <div>
            <h3 class="font-semibold mb-2">Video Creation Guide</h3>
            <p class="text-muted-foreground mb-2">Learn how to create viral short-form videos</p>
            <a href="#" class="inline-flex items-center gap-1 text-blue-500 hover:text-blue-600 font-medium">
              Read Guide
              <ArrowRight className="w-4 h-4" />
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- My Product Stack -->
    <section class="mb-24">
      <h2 class="text-2xl font-bold mb-6">My Product Stack</h2>
      <div class="space-y-6">
        <div class="flex items-start gap-4">
          <span class="text-xl">‚ö°</span>
          <div>
            <h3 class="font-semibold mb-1">
              Framework: 
              <a 
                href="https://astro.build" 
                target="_blank" 
                class="inline-flex items-center gap-1 text-blue-500 hover:text-blue-600"
              >
                Astro
                <ExternalLink className="w-4 h-4" />
              </a>
            </h3>
            <p class="text-sm text-muted-foreground">Build fast content-focused websites</p>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <span class="text-xl">üé®</span>
          <div>
            <h3 class="font-semibold mb-1">UI Components: <a href="https://ui.shadcn.com" target="_blank" class="text-blue-500 hover:underline">shadcn/ui</a></h3>
            <p class="text-sm text-muted-foreground">Beautifully designed components built with Radix UI and Tailwind</p>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <span class="text-xl">üéØ</span>
          <div>
            <h3 class="font-semibold mb-1">Styling: <a href="https://tailwindcss.com" target="_blank" class="text-blue-500 hover:underline">TailwindCSS</a></h3>
            <p class="text-sm text-muted-foreground">A utility-first CSS framework for rapid UI development</p>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <span class="text-xl">‚ú®</span>
          <div>
            <h3 class="font-semibold mb-1">Icons: <a href="https://lucide.dev" target="_blank" class="text-blue-500 hover:underline">Lucide Icons</a></h3>
            <p class="text-sm text-muted-foreground">Beautiful & consistent icons for your UI</p>
          </div>
        </div>
        <div class="flex items-start gap-4">
          <span class="text-xl">üî∑</span>
          <div>
            <h3 class="font-semibold mb-1">Language: <a href="https://www.typescriptlang.org" target="_blank" class="text-blue-500 hover:underline">TypeScript</a></h3>
            <p class="text-sm text-muted-foreground">JavaScript with syntax for types</p>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  /* Add styles for dialog animation */
  [data-state='open'] {
    animation: fadeIn 0.2s ease-out;
  }

  [data-state='closed'] {
    animation: fadeOut 0.2s ease-in;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }

  @keyframes fadeOut {
    from { opacity: 1; transform: scale(1); }
    to { opacity: 0; transform: scale(0.95); }
  }
</style>
